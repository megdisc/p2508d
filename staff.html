<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>p2508d - 職員管理モックアップ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="mockup-container">
        <header class="header">
            <div>
                <h1 class="header-logo"><a href="dashboard.html">p2508d</a></h1>
            </div>

            <nav class="nav" id="side-nav">
                <ul class="nav-list">
                    <li><a href="dashboard.html" class="nav-link">ダッシュボード</a></li>
                    <li><a href="daily_records.html" class="nav-link">日々の記録</a></li>
                    <li><a href="members_menu.html" class="nav-link">利用者支援</a></li>
                    <li><a href="staff.html" class="nav-link active">職員管理</a></li>
                    <li><a href="work_activities_menu.html" class="nav-link">生産活動</a></li>
                    <li><a href="accounting_menu.html" class="nav-link">会計管理</a></li>
                    <li><a href="claims.html" class="nav-link">国保連請求</a></li>
                    <li><a href="analytics.html" class="nav-link">データ分析</a></li>
                    <li><a href="settings.html" class="nav-link">設定</a></li>
                </ul>
                <div class="nav-logout-section">
                    <a href="index.html" class="nav-link">ログアウト</a>
                </div>
            </nav>
        </header>

        <main class="mockup-main">
            <div id="staff" class="mockup-page active">
                <div class="list-page-header">
                    <h1 class="page-title">職員一覧</h1>
                    <button class="button button-primary" onclick="openModal('edit-staff-basic-modal')">＋ 新規作成</button>
                </div>

                <div class="section">
                    <form class="section-content filter-form-inline" style="margin-bottom: 1.5rem;">
                        <div class="form-group" style="flex-grow: 2;">
                            <label for="search-staff-name" class="form-label">職員名</label>
                            <input type="text" id="search-staff-name" class="form-control" placeholder="氏名で検索...">
                        </div>
                        <div class="form-group">
                            <label for="filter-staff-role" class="form-label">役職</label>
                            <select id="filter-staff-role" class="form-control">
                                <option value="">すべて</option>
                                <option value="管理者">管理者</option>
                                <option value="サービス管理責任者">サービス管理責任者</option>
                                <option value="職業指導員">職業指導員</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="filter-staff-status" class="form-label">雇用形態</label>
                            <select id="filter-staff-status" class="form-control">
                                <option value="">すべて</option>
                                <option value="常勤">常勤</option>
                                <option value="非常勤">非常勤</option>
                            </select>
                        </div>
                        <button type="button" class="button button-secondary">クリア</button>
                    </form>

                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>職員名</th>
                                    <th>役職</th>
                                    <th>雇用形態</th>
                                </tr>
                            </thead>
                            <tbody id="staff-list-tbody">
                                <tr class="clickable-row" onclick="showPage('staff-detail')">
                                    <td>管理者 太郎</td>
                                    <td>管理者</td>
                                    <td>常勤</td>
                                </tr>
                                <tr class="clickable-row" onclick="showPage('staff-detail')">
                                    <td>支援員 次郎</td>
                                    <td>サービス管理責任者</td>
                                    <td>常勤</td>
                                </tr>
                                 <tr class="clickable-row" onclick="showPage('staff-detail')">
                                    <td>職業指導員 三郎</td>
                                    <td>職業指導員</td>
                                    <td>非常勤</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="staff-detail" class="mockup-page">
                <div class="list-page-header">
                    <h1 class="page-title">管理者 太郎</h1>
                    <div>
                        <a href="#staff" class="button button-secondary" style="margin-right: 0.5rem;" onclick="showPage('staff')">一覧へ戻る</a>
                        <button type="button" class="button button-danger" onclick="alert('「管理者 太郎」様のデータを削除します。よろしいですか？')">削除</button>
                    </div>
                </div>

                <div class="sub-nav">
                    <ul id="staff-detail-subnav">
                        <li><a href="#" class="sub-nav-item active" data-tab="tab-basic-info">基本情報</a></li>
                        <li><a href="#" class="sub-nav-item" data-tab="tab-schedule">シフト・勤怠</a></li>
                        <li><a href="#" class="sub-nav-item" data-tab="tab-payroll">給与情報</a></li>
                        <li><a href="#" class="sub-nav-item" data-tab="tab-training">研修記録</a></li>
                    </ul>
                </div>

                <div class="tab-content-wrapper">
                    <div id="tab-basic-info" class="tab-content active">
                        <div class="section">
                            <div class="section-header">
                                <h2 class="section-title-in-header">職員情報</h2>
                                <button class="button button-primary" onclick="openModal('edit-staff-basic-modal')">編集</button>
                            </div>
                            <div class="section-content">
                                <dl class="detail-grid">
                                    <dt>氏名</dt><dd>管理者 太郎</dd>
                                    <dt>フリガナ</dt><dd>カンリシャ タロウ</dd>
                                    <dt>役職</dt><dd>管理者</dd>
                                    <dt>雇用形態</dt><dd>常勤</dd>
                                    <dt>入社日</dt><dd>2023年4月1日</dd>
                                </dl>
                                </div>
                        </div>
                    </div>

                    <div id="tab-schedule" class="tab-content">
                        <div class="section">
                            <h2 class="section-title">2025年 10月</h2>
                            <div class="section-content">
                                <p>日ごとのシフト（早番/遅番/休み）や出退勤時刻、休憩時間を記録するためのカレンダーUIをここに配置します。</p>
                            </div>
                        </div>
                    </div>

                    <div id="tab-payroll" class="tab-content">
                         <div class="section">
                            <div class="section-header">
                                <h2 class="section-title-in-header">給与設定</h2>
                                <button class="button button-primary" onclick="openModal('edit-staff-payroll-modal')">編集</button>
                            </div>
                            <div class="section-content">
                                <dl class="detail-grid" style="grid-template-columns: 100px 1fr;">
                                    <dt>基本給</dt><dd>300,000 円</dd>
                                    <dt>役職手当</dt><dd>50,000 円</dd>
                                </dl>
                                </div>
                        </div>
                        <div class="section">
                            <h2 class="section-title">給与明細履歴</h2>
                            <div class="table-wrapper">
                                <table class="table">
                                    <thead><tr><th>対象月</th><th>総支給額</th><th>控除額合計</th><th>差引支給額</th><th class="col-actions">操作</th></tr></thead>
                                    <tbody>
                                        <tr>
                                            <td>2025年9月</td>
                                            <td>350,000円</td>
                                            <td>50,000円</td>
                                            <td>300,000円</td>
                                            <td class="col-actions"><div class="table-button-group"><button class="button button-secondary">明細</button></div></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div id="tab-training" class="tab-content">
                        <div class="section">
                            <div class="list-page-header" style="margin-bottom: 1rem;">
                                <h2 class="section-title" style="margin: 0; border: none;">研修受講履歴</h2>
                                <button class="button button-primary" onclick="openModal('add-training-modal')">＋ 研修を追加</button>
                                </div>
                            <div class="table-wrapper">
                                 <table class="table">
                                    <thead><tr><th>研修名</th><th>実施日</th><th>種別</th><th class="col-actions">操作</th></tr></thead>
                                    <tbody>
                                        <tr>
                                            <td>虐待防止研修</td>
                                            <td>2025/08/10</td>
                                            <td>内部研修</td>
                                            <td class="col-actions">
                                                <div class="table-button-group">
                                                    <button class="button button-secondary" onclick="openModal('add-training-modal')">詳細</button>
                                                    <button class="button button-danger">削除</button>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>サービス管理責任者研修</td>
                                            <td>2025/06/01</td>
                                            <td>外部研修</td>
                                            <td class="col-actions">
                                                <div class="table-button-group">
                                                    <button class="button button-secondary" onclick="openModal('add-training-modal')">詳細</button>
                                                    <button class="button button-danger">削除</button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </main>
    </div>

    <div id="edit-staff-basic-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">職員情報 編集</h2>
                <span class="modal-close" onclick="closeModal('edit-staff-basic-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>氏名</label>
                    <input type="text" class="form-control" value="管理者 太郎">
                </div>
                <div class="form-group">
                    <label>フリガナ</label>
                    <input type="text" class="form-control" value="カンリシャ タロウ">
                </div>
                <div class="form-group">
                    <label>役職</label>
                    <select class="form-control">
                        <option selected>管理者</option>
                        <option>サービス管理責任者</option>
                        <option>職業指導員</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>雇用形態</label>
                    <select class="form-control">
                        <option selected>常勤</option>
                        <option>非常勤</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>入社日</label>
                    <input type="date" class="form-control" value="2023-04-01">
                </div>
            </div>
            <div class="modal-footer">
                <button class="button button-secondary" onclick="closeModal('edit-staff-basic-modal')">キャンセル</button>
                <button class="button button-primary">保存</button>
            </div>
        </div>
    </div>

    <div id="edit-staff-payroll-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">給与設定 編集</h2>
                <span class="modal-close" onclick="closeModal('edit-staff-payroll-modal')">&times;</span>
            </div>
            <div class="modal-body">
                 <div class="form-group">
                    <label>基本給 (円)</label>
                    <input type="number" class="form-control" value="300000">
                </div>
                <div class="form-group">
                    <label>役職手当 (円)</label>
                    <input type="number" class="form-control" value="50000">
                </div>
            </div>
            <div class="modal-footer">
                <button class="button button-secondary" onclick="closeModal('edit-staff-payroll-modal')">キャンセル</button>
                <button class="button button-primary">保存</button>
            </div>
        </div>
    </div>

    <div id="add-training-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">研修記録 編集</h2>
                <span class="modal-close" onclick="closeModal('add-training-modal')">&times;</span>
            </div>
            <div class="modal-body">
                 <div class="form-group">
                    <label>研修名</label>
                    <input type="text" class="form-control" value="虐待防止研修">
                </div>
                <div class="form-group">
                    <label>実施日</label>
                    <input type="date" class="form-control" value="2025-08-10">
                </div>
                 <div class="form-group">
                    <label>種別</label>
                    <select class="form-control">
                        <option selected>内部研修</option>
                        <option>外部研修</option>
                    </select>
                </div>
                 <div class="form-group">
                    <label>詳細・メモ</label>
                    <textarea class="form-control" rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="button button-secondary" onclick="closeModal('add-training-modal')">キャンセル</button>
                <button class="button button-primary">保存</button>
            </div>
        </div>
    </div>
    <script src="script.js"></script>

    <script>
        // 職員一覧の簡易フィルタリング関数
        function filterStaff() {
            const nameInput = document.getElementById('search-staff-name');
            const roleSelect = document.getElementById('filter-staff-role');
            const statusSelect = document.getElementById('filter-staff-status');
            const tableBody = document.getElementById('staff-list-tbody');

            if (!nameInput || !roleSelect || !statusSelect || !tableBody) {
                // console.warn("Filter elements or table body for staff not found.");
                return;
            }

            const nameFilter = nameInput.value.toLowerCase();
            const roleFilter = roleSelect.value;
            const statusFilter = statusSelect.value;
            const rows = tableBody.getElementsByTagName('tr');

            Array.from(rows).forEach(row => {
                const staffName = row.cells[0]?.textContent.toLowerCase() || '';
                const role = row.cells[1]?.textContent || '';
                const status = row.cells[2]?.textContent || '';

                const nameMatch = staffName.includes(nameFilter);
                const roleMatch = roleFilter === "" || role === roleFilter;
                const statusMatch = statusFilter === "" || status === statusFilter;

                if (nameMatch && roleMatch && statusMatch) {
                    row.style.display = ''; // 表示
                } else {
                    row.style.display = 'none'; // 非表示
                }
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            // --- 職員詳細: サブナビゲーション（タブ）切り替え ---
            const subNavContainer = document.getElementById('staff-detail-subnav');
            const tabContents = document.querySelectorAll('#staff-detail .tab-content-wrapper .tab-content');

            if (subNavContainer && tabContents.length > 0) {
                subNavContainer.addEventListener('click', (e) => {
                    const navItem = e.target.closest('.sub-nav-item');
                    if (!navItem || navItem.classList.contains('active')) { return; }
                    e.preventDefault();

                    const targetTabId = navItem.dataset.tab;

                    // サブナビのアクティブ状態を更新
                    subNavContainer.querySelectorAll('.sub-nav-item').forEach(item => { item.classList.remove('active'); });
                    navItem.classList.add('active');

                    // タブコンテンツの表示を切り替え
                    tabContents.forEach(content => {
                        content.classList.toggle('active', content.id === targetTabId);
                        content.style.display = (content.id === targetTabId) ? 'block' : 'none'; // displayも制御
                    });
                });
                // 初期表示制御
                const initialActiveNavItem = subNavContainer.querySelector('.sub-nav-item.active');
                const initialTargetTabId = initialActiveNavItem?.dataset.tab;
                tabContents.forEach(content => {
                    const isActive = initialTargetTabId && content.id === initialTargetTabId;
                    content.classList.toggle('active', isActive);
                    content.style.display = isActive ? 'block' : 'none';
                });
            }

            // --- 職員一覧: フィルタリングのイベントリスナー設定 ---
            if (typeof window.filterStaff === 'function') {
                const nameInputListener = document.getElementById('search-staff-name');
                const roleSelectListener = document.getElementById('filter-staff-role');
                const statusSelectListener = document.getElementById('filter-staff-status');
                const clearButton = document.querySelector('#staff .filter-form-inline .button-secondary'); // セレクタをインラインフォーム内のボタンに修正

                if(nameInputListener) nameInputListener.addEventListener('input', filterStaff);
                if(roleSelectListener) roleSelectListener.addEventListener('change', filterStaff);
                if(statusSelectListener) statusSelectListener.addEventListener('change', filterStaff);

                if(clearButton) {
                    clearButton.addEventListener('click', () => {
                         const form = document.querySelector('#staff .filter-form-inline'); // セレクタをインラインフォームに修正
                         if (form) form.reset();
                         filterStaff();
                    });
                }

                // 初期表示のための呼び出し
                filterStaff();
            }
        });
    </script>
    </body>
</html>
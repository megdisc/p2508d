<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>p2508d - スキル体系設定</title>

    <link rel="stylesheet" href="../style.css">

    <style>
        /* --- テーブル内のフォーム要素 (工賃体系設定/案件管理のスタイルに合わせる) --- */
        .table .form-control {
            width: 100%;
            padding: 0.375rem 0.5rem; /* テーブル内は少し小さく */
            font-size: var(--font-size-sm);
            box-sizing: border-box;
        }

        /* --- 検索/ページネーション (style.cssの定義を流用) --- */
        .table-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .search-form {
            display: flex;
            gap: 0.5rem;
        }
        .search-form .form-control {
            width: 300px;
        }
        .pagination-controls {
            display: flex;
            justify-content: flex-end; 
            align-items: center;
            margin-top: 1rem;
        }
        .items-per-page {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: var(--font-size-sm);
        }
        /* (追加) 表示件数選択 select の幅を自動にする */
        .items-per-page .form-control {
            width: auto;
        }
        .pagination-nav {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: var(--font-size-sm);
        }
        /* ソート用リンク (style.cssの定義を流用) */
        .sort-link {
            color: inherit;
            text-decoration: none;
            cursor: pointer;
        }
        .sort-link:hover {
            text-decoration: underline;
        }
    </style>
    </head>
<body>

    <div class="mockup-container">
        <header class="header">
            <div>
                <h1 class="header-logo"><a href="../dashboard/index.html">p2508d</a></h1>
            </div>
            
            <nav class="nav" id="side-nav">
                <ul class="nav-list">
                    <li><a href="../dashboard/index.html" class="nav-link">ダッシュボード</a></li>
                    <li><a href="../records/index.html" class="nav-link">日々の記録</a></li>
                    <li><a href="../members/index.html" class="nav-link">利用者支援</a></li>
                    <li><a href="../staff/index.html" class="nav-link">職員管理</a></li>
                    <li><a href="../production/index.html" class="nav-link">生産活動</a></li>
                    <li><a href="../accounting/index.html" class="nav-link">会計管理</a></li>
                    <li><a href="../billing/index.html" class="nav-link">国保連請求</a></li>
                    <li><a href="../analytics/index.html" class="nav-link">データ分析</a></li>
                    <li><a href="../settings/index.html" class="nav-link active">設定</a></li>
                </ul>
                <div class="nav-logout-section">
                    <a href="../index.html" class="nav-link">ログアウト</a>
                </div>
            </nav>
            
        </header>

        <main class="mockup-main">
            
            <div id="skill-system-detail" class="mockup-page active">
                <div class="list-page-header">
                     <h1 class="page-title">スキル体系設定</h1>
                     <div>
                        <a href="../settings/index.html" class="button button-secondary">設定TOPへ戻る</a>
                     </div>
                </div>

                <div class="tabs" id="skill-system-tabs">
                    <div class="tab-item active" data-tab="tab-skill-categories">スキルカテゴリ</div>
                    <div class="tab-item" data-tab="tab-skill-items">スキル項目</div>
                    <div class="tab-item" data-tab="tab-skill-levels">習熟度レベル</div>
                </div>

                <div class="tab-content-wrapper">
                    
                    <div id="tab-skill-categories" class="tab-content active">
                        <div class="list-page-header" style="margin-bottom: 1rem;">
                            <h2 class="section-title" style="margin: 0; border: none;">スキルカテゴリ設定</h2>
                            <button type="button" class="button button-primary" id="add-category-row">＋ カテゴリを追加</button>
                        </div>
                        
                        <div class="table-controls">
                            <div class="search-form">
                                <input type="text" placeholder="カテゴリ名で検索..." class="form-control" id="search-category">
                            </div>
                            <div class="items-per-page">
                                <label for="items-per-page-cat">表示件数:</label>
                                <select id="items-per-page-cat" class="form-control">
                                    <option value="20">20</option>
                                    <option value="50" selected>50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>

                        <div class="table-wrapper">
                            <table class="table" id="category-table">
                                <thead>
                                    <tr>
                                        <th><a href="#" class="sort-link">カテゴリ名</a></th>
                                        <th style="width: 250px;"><a href="#" class="sort-link">親カテゴリ</a></th>
                                        <th class="col-actions">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="category-table-body">
                                    <tr>
                                        <td><input type="text" class="form-control" value="マーケティング"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="root" selected>(ルートカテゴリ)</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="デザイン"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="root" selected>(ルートカテゴリ)</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="開発"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="root" selected>(ルートカテゴリ)</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="SEO/広告"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="root">(ルートカテゴリ)</option>
                                                <option value="mkt" selected>マーケティング</option>
                                                <option value="des" disabled>デザイン</option>
                                                <option value="dev" disabled>開発</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="SNS"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="root">(ルートカテゴリ)</option>
                                                <option value="mkt" selected>マーケティング</option>
                                                <option value="des" disabled>デザイン</option>
                                                <option value="dev" disabled>開発</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="UI/UX"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="root">(ルートカテゴリ)</option>
                                                <option value="mkt" disabled>マーケティング</option>
                                                <option value="des" selected>デザイン</option>
                                                <option value="dev" disabled>開発</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="グラフィック"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="root">(ルートカテゴリ)</option>
                                                <option value="mkt" disabled>マーケティング</option>
                                                <option value="des" selected>デザイン</option>
                                                <option value="dev" disabled>開発</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="フロントエンド"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="root">(ルートカテゴリ)</option>
                                                <option value="mkt" disabled>マーケティング</option>
                                                <option value="des" disabled>デザイン</option>
                                                <option value="dev" selected>開発</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="バックエンド"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="root">(ルートカテゴリ)</option>
                                                <option value="mkt" disabled>マーケティング</option>
                                                <option value="des" disabled>デザイン</option>
                                                <option value="dev" selected>開発</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="pagination-controls">
                            <div class="pagination-nav">
                                <span>1 - 9 / 9件中</span>
                                <button class="button button-secondary" disabled>&lt; 前へ</button>
                                <button class="button button-secondary">次へ &gt;</button>
                            </div>
                        </div>
                    </div>
                    <div id="tab-skill-items" class="tab-content">
                        <div class="list-page-header" style="margin-bottom: 1rem;">
                            <h2 class="section-title" style="margin: 0; border: none;">スキル項目設定</h2>
                            <button type="button" class="button button-primary" id="add-skill-item-row">＋ 項目を追加</button>
                        </div>

                        <div class="table-controls">
                            <div class="search-form">
                                <input type="text" placeholder="スキル名で検索..." class="form-control" id="search-skill-item">
                            </div>
                            <div class="items-per-page">
                                <label for="items-per-page-item">表示件数:</label>
                                <select id="items-per-page-item" class="form-control">
                                    <option value="20">20</option>
                                    <option value="50" selected>50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>

                        <div class="table-wrapper">
                            <table class="table" id="skill-item-table">
                                <thead>
                                    <tr>
                                        <th><a href="#" class="sort-link">スキル名</a></th>
                                        <th style="width: 250px;"><a href="#" class="sort-link">カテゴリ</a></th>
                                        <th class="col-actions">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="skill-item-table-body">
                                    <tr>
                                        <td><input type="text" class="form-control" value="キーワードリサーチ"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="mkt">マーケティング</option>
                                                <option value="seo_ad" selected>└ SEO/広告</option>
                                                <option value="sns">└ SNS</option>
                                                <option value="des">デザイン</option>
                                                <option value="ui_ux">└ UI/UX</option>
                                                <option value="gfx">└ グラフィック</option>
                                                <option value="dev">開発</option>
                                                <option value="front">└ フロントエンド</option>
                                                <option value="back">└ バックエンド</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="GA4分析"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="mkt">マーケティング</option>
                                                <option value="seo_ad" selected>└ SEO/広告</option>
                                                <option value="sns">└ SNS</option>
                                                <option value="des">デザイン</option>
                                                <option value="ui_ux">└ UI/UX</option>
                                                <option value="gfx">└ グラフィック</option>
                                                <option value="dev">開発</option>
                                                <option value="front">└ フロントエンド</option>
                                                <option value="back">└ バックエンド</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="Instagram投稿作成"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="mkt">マーケティング</option>
                                                <option value="seo_ad">└ SEO/広告</option>
                                                <option value="sns" selected>└ SNS</option>
                                                <option value="des">デザイン</option>
                                                <option value="ui_ux">└ UI/UX</option>
                                                <option value="gfx">└ グラフィック</option>
                                                <option value="dev">開発</option>
                                                <option value="front">└ フロントエンド</option>
                                                <option value="back">└ バックエンド</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="ワイヤーフレーム作成"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="mkt">マーケティング</option>
                                                <option value="seo_ad">└ SEO/広告</option>
                                                <option value="sns">└ SNS</option>
                                                <option value="des">デザイン</option>
                                                <option value="ui_ux" selected>└ UI/UX</option>
                                                <option value="gfx">└ グラフィック</option>
                                                <option value="dev">開発</option>
                                                <option value="front">└ フロントエンド</option>
                                                <option value="back">└ バックエンド</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="バナー作成 (Figma)"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="mkt">マーケティング</option>
                                                <option value="seo_ad">└ SEO/広告</option>
                                                <option value="sns">└ SNS</option>
                                                <option value="des">デザイン</option>
                                                <option value="ui_ux">└ UI/UX</option>
                                                <option value="gfx" selected>└ グラフィック</option>
                                                <option value="dev">開発</option>
                                                <option value="front">└ フロントエンド</option>
                                                <option value="back">└ バックエンド</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="HTML/CSSコーディング"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="mkt">マーケティング</option>
                                                <option value="seo_ad">└ SEO/広告</option>
                                                <option value="sns">└ SNS</option>
                                                <option value="des">デザイン</option>
                                                <option value="ui_ux">└ UI/UX</option>
                                                <option value="gfx">└ グラフィック</option>
                                                <option value="dev">開発</option>
                                                <option value="front" selected>└ フロントエンド</option>
                                                <option value="back">└ バックエンド</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="API開発 (Node.js)"></td>
                                        <td>
                                            <select class="form-control">
                                                <option value="mkt">マーケティング</option>
                                                <option value="seo_ad">└ SEO/広告</option>
                                                <option value="sns">└ SNS</option>
                                                <option value="des">デザイン</option>
                                                <option value="ui_ux">└ UI/UX</option>
                                                <option value="gfx">└ グラフィック</option>
                                                <option value="dev">開発</option>
                                                <option value="front">└ フロントエンド</option>
                                                <option value="back" selected>└ バックエンド</option>
                                            </select>
                                        </td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="pagination-controls">
                            <div class="pagination-nav">
                                <span>1 - 7 / 7件中</span>
                                <button class="button button-secondary" disabled>&lt; 前へ</button>
                                <button class="button button-secondary">次へ &gt;</button>
                            </div>
                        </div>
                    </div>
                    <div id="tab-skill-levels" class="tab-content">
                        <div class="list-page-header" style="margin-bottom: 1rem;">
                            <h2 class="section-title" style="margin: 0; border: none;">習熟度レベル設定</h2>
                            <button type="button" class="button button-primary" id="add-level-row">＋ レベルを追加</button>
                        </div>
                        <div class="table-wrapper">
                            <table class="table" id="level-table">
                                <thead>
                                    <tr>
                                        <th style="width: 150px;">レベル名</th>
                                        <th>説明</th>
                                        <th class="col-actions">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="level-table-body">
                                    <tr>
                                        <td><input type="text" class="form-control" value="Lv.0"></td>
                                        <td><input type="text" class="form-control" value="未学習・見学"></td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="Lv.1"></td>
                                        <td><input type="text" class="form-control" value="要支援・練習中"></td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="Lv.2"></td>
                                        <td><input type="text" class="form-control" value="独力で作業可能"></td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input type="text" class="form-control" value="Lv.3"></td>
                                        <td><input type="text" class="form-control" value="指導・検品が可能"></td>
                                        <td class="col-actions">
                                            <div class="table-button-group">
                                                <button type="button" class="button button-danger">削除</button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>

            </div>

        </main>
    </div>

    <template id="category-row-template">
        <tr>
            <td><input type="text" class="form-control" placeholder="新規カテゴリ名"></td>
            <td>
                <select class="form-control">
                    <option value="root" selected>(ルートカテゴリ)</option>
                    <option value="mkt">マーケティング</option>
                    <option value="des">デザイン</option>
                    <option value="dev">開発</option>
                    <option value="seo_ad">└ SEO/広告</option>
                    <option value="sns">└ SNS</option>
                    <option value="ui_ux">└ UI/UX</option>
                    <option value="gfx">└ グラフィック</option>
                    <option valueG="front">└ フロントエンド</option>
                    <option value="back">└ バックエンド</option>
                </select>
            </td>
            <td class="col-actions">
                <div class="table-button-group">
                    <button type="button" class="button button-danger">削除</button>
                </div>
            </td>
        </tr>
    </template>

    <template id="skill-item-row-template">
        <tr>
            <td><input type="text" class="form-control" placeholder="新規スキル名"></td>
            <td>
                <select class="form-control">
                    <option value="">カテゴリを選択</option>
                    <option value="mkt">マーケティング</option>
                    <option value="seo_ad">└ SEO/広告</option>
                    <option value="sns">└ SNS</option>
                    <option value="des">デザイン</option>
                    <option value="ui_ux">└ UI/UX</option>
                    <option value="gfx">└ グラフィック</option>
                    <option value="dev">開発</option>
                    <option value="front">└ フロントエンド</option>
                    <option value="back">└ バックエンド</option>
                </select>
            </td>
            <td class="col-actions">
                <div class="table-button-group">
                    <button type="button" class="button button-danger">削除</button>
                </div>
            </td>
        </tr>
    </template>

    <template id="level-row-template">
        <tr>
            <td><input type="text" class="form-control" placeholder="例: Lv.4"></td>
            <td><input type="text" class="form-control" placeholder="レベルの説明"></td>
            <td class="col-actions">
                <div class="table-button-group">
                    <button type="button" class="button button-danger">削除</button>
                </div>
            </td>
        </tr>
    </template>


    <script src="../script.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- テーブル行追加・削除の汎用ロジック ---
            function setupTableRowAdder(tbodyId, addButtonId, templateId) {
                const tbody = document.getElementById(tbodyId);
                const addButton = document.getElementById(addButtonId);
                const template = document.getElementById(templateId);

                if (!tbody || !addButton || !template) {
                    console.warn('Table adder elements not found for', tbodyId);
                    return;
                }

                // 行追加
                addButton.addEventListener('click', () => {
                    const clone = template.content.cloneNode(true);
                    tbody.appendChild(clone);
                });

                // 行削除 (イベント委任)
                tbody.addEventListener('click', (e) => {
                    const deleteButton = e.target.closest('.button-danger');
                    if (deleteButton) {
                        deleteButton.closest('tr').remove();
                    }
                });
            }

            // スキルカテゴリの初期化
            setupTableRowAdder('category-table-body', 'add-category-row', 'category-row-template');
            
            // スキル項目の初期化
            setupTableRowAdder('skill-item-table-body', 'add-skill-item-row', 'skill-item-row-template');

            // 習熟度レベルの初期化
            setupTableRowAdder('level-table-body', 'add-level-row', 'level-row-template');


            // --- リアルタイム検索の汎用ロジック ---
            function setupRealtimeSearch(inputId, tbodyId) {
                const searchInput = document.getElementById(inputId);
                const tableBody = document.getElementById(tbodyId);

                if (!searchInput || !tableBody) {
                    console.warn('Search elements not found for', inputId);
                    return;
                }

                searchInput.addEventListener('input', () => {
                    const searchTerm = searchInput.value.toLowerCase();
                    const rows = tableBody.getElementsByTagName('tr');

                    Array.from(rows).forEach(row => {
                        const inputInCell = row.querySelector('td:first-child input');
                        if (inputInCell) {
                            const cellValue = inputInCell.value.toLowerCase();
                            if (cellValue.includes(searchTerm)) {
                                row.style.display = ''; // 表示
                            } else {
                                row.style.display = 'none'; // 非表示
                            }
                        }
                    });
                });
            }

            // スキルカテゴリのリアルタイム検索を初期化
            setupRealtimeSearch('search-category', 'category-table-body');
            
            // スキル項目のリアルタイム検索を初期化
            setupRealtimeSearch('search-skill-item', 'skill-item-table-body');
        });
    </script>

</body>
</html>